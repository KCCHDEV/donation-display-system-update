# ระบบแสดงรายชื่อผู้บริจาคในงานทอดผ้าป่าสามัคคีเพื่อการศึกษา

โปรเจกต์นี้ใช้สำหรับแสดงรายชื่อผู้บริจาคและยอดเงินจาก Google Sheets ในรูปแบบข้อความเลื่อนขึ้น (Marquee) พร้อมแสดงยอดเงินรวม ในงานทอดผ้าป่าสามัคคีเพื่อการศึกษา เนื่องในวาระครบรอบ 60 ปี โรงเรียนชะอำคุณหญิงเนื่องบุรี

---

## โครงสร้างไฟล์

```
scroll text generator/
│
├── index.html         // ไฟล์ HTML หลัก
├── style.css          // ไฟล์ตกแต่งหน้าตา (CSS)
├── main.js            // ไฟล์ควบคุมการทำงาน (JavaScript)
├── img/
│   └── chnb-logo.svg  // โลโก้ (เปลี่ยนได้)
```

---

## วิธีใช้งาน

1. แตกไฟล์ทั้งหมดไว้ในโฟลเดอร์เดียวกัน
2. เปิดไฟล์ `index.html` ด้วยเว็บเบราว์เซอร์ (Chrome/Edge/Firefox)
3. ระบบจะดึงข้อมูลจาก Google Sheets อัตโนมัติและแสดงผล

---

## จุดที่ต้องแก้ไข (สำหรับผู้ใช้งาน)

### 1. ตั้งค่าสีหลัก สีรอง และโลโก้

- เปิดไฟล์ `style.css` แล้วแก้ไขค่าตัวแปรในส่วนบนสุด เช่น

    ```css
    :root {
      --primary-color: #198754;   /* สีหลัก */
      --secondary-color: #ffc107; /* สีรอง */
    }
    ```

- เปลี่ยนโลโก้ในไฟล์ `index.html`  
  ตัวอย่าง:
    ```html
    <img src="img/chnb-logo.svg" alt="โลโก้" class="logo">
    ```
  หากต้องการใช้โลโก้ของคุณเอง ให้นำไฟล์โลโก้ไปไว้ในโฟลเดอร์ `img/` แล้วเปลี่ยนชื่อไฟล์ในบรรทัดนี้

---

### 2. ตั้งค่า Google Sheets API

#### โครงสร้าง URL สำหรับดึงข้อมูล

```
https://sheets.googleapis.com/v4/spreadsheets/{SPREADSHEET_ID}/values/{SHEET_NAME!RANGE}?key={API_KEY}
```

- `{SPREADSHEET_ID}` : รหัสของ Google Sheets (ดูได้จาก URL ของไฟล์ Google Sheets)
- `{SHEET_NAME}` : ชื่อชีท (เช่น `บัญชีทอดผ้าป่าฯ` หรือ `บัญชีรายได้สถานศึกษา`)
- `{RANGE}` : ช่วงเซลล์ที่ต้องการดึงข้อมูล (เช่น `B:D` หรือ `A1:J7`)
- `{API_KEY}` : Google API Key ของคุณ

**ตัวอย่าง**

```javascript
const SHEETS_API_URL = 'https://sheets.googleapis.com/v4/spreadsheets/1AbCDefGhIJKlmnOPQrstUvWxYz1234567890/values/A1:J7?key=YOUR_API_KEY';
const BANK_API_URL = 'https://sheets.googleapis.com/v4/spreadsheets/1AbCDefGhIJKlmnOPQrstUvWxYz1234567890/values/บัญชีทอดผ้าป่าฯ!B:D?key=YOUR_API_KEY';
const SCHOOL_API_URL = 'https://sheets.googleapis.com/v4/spreadsheets/1AbCDefGhIJKlmnOPQrstUvWxYz1234567890/values/บัญชีรายได้สถานศึกษา!B:D?key=YOUR_API_KEY';
```

#### ขั้นตอนการตั้งค่า

1. **เปิด Google Sheets ที่ต้องการใช้งาน**
2. **คัดลอก SPREADSHEET_ID**  
   - ตัวอย่าง:  
     ```
     https://docs.google.com/spreadsheets/d/1AbCDefGhIJKlmnOPQrstUvWxYz1234567890/edit#gid=0
     ```
     - SPREADSHEET_ID คือ `1AbCDefGhIJKlmnOPQrstUvWxYz1234567890`
3. **ตรวจสอบชื่อชีท**  
   - เช่น `บัญชีทอดผ้าป่าฯ` หรือ `บัญชีรายได้สถานศึกษา` (ต้องตรงกับใน Google Sheets)
4. **กำหนดช่วงเซลล์ (Range)**  
   - เช่น `B:D` หรือ `A1:J7` ตามโครงสร้างข้อมูลของคุณ
5. **สร้างหรือใช้ Google API Key**  
   - เปิด [Google Cloud Console](https://console.cloud.google.com/)
   - สร้าง Project ใหม่หรือเลือก Project ที่ต้องการ
   - ไปที่เมนู **APIs & Services > Library** แล้วค้นหา **Google Sheets API** และกด Enable
   - ไปที่ **APIs & Services > Credentials** แล้วกด **Create Credentials > API key**
   - คัดลอก API Key ที่ได้มาใช้ใน URL
6. **นำข้อมูลทั้งหมดไปใส่ใน URL ตามโครงสร้างด้านบน**
7. **นำ URL ที่ได้ไปแทนที่ในไฟล์ `main.js`**

> **หมายเหตุ:**  
> - ต้องเปิดสิทธิ์ Google Sheets เป็น "Anyone with the link can view"
> - หากเปลี่ยนชื่อชีทหรือช่วงเซลล์ ต้องแก้ไข URL ให้ตรงกัน

---

### 3. ชื่อชีทใน Google Sheets

- ชื่อชีทต้องตรงกับที่ระบุใน URL (เช่น `บัญชีทอดผ้าป่าาฯ`, `บัญชีรายได้สถานศึกษา`)
- ถ้าเปลี่ยนชื่อชีท ต้องแก้ URL ใน `main.js` ให้ตรง

---

## ฟีเจอร์

- แสดงยอดเงินรวม, ยอดเงินบริจาค, ยอดสั่งจองพระเครื่อง (บนสุด)
- แสดงรายชื่อผู้บริจาค (บัญชีทอดผ้าป่าสามัคคี และบัญชีรายได้สถานศึกษา) แบบเลื่อนขึ้นอัตโนมัติ
- เรียงลำดับจากยอดเงินมากไปน้อย
- อัปเดตข้อมูลอัตโนมัติทุก 10 นาที
- รองรับมือถือและจอใหญ่ (Responsive)
- ดีไซน์ทันสมัย สีเขียว-เหลือง

---

## หมายเหตุ

- หากข้อมูลไม่แสดง ให้ตรวจสอบ API Key, สิทธิ์ Google Sheets, และชื่อชีทใน Google Sheets ว่าตรงกับที่กำหนดในโค้ดหรือไม่
- หากต้องการเพิ่มหมวดหมู่หรือเปลี่ยนรูปแบบการแสดงผล สามารถแก้ไขในไฟล์ `main.js` ได้

---

## ตัวอย่างผลลัพธ์

หลังจากตั้งค่าและใช้งานโปรเจกต์เสร็จสิ้น ระบบจะแสดงผลลัพธ์ในรูปแบบข้อความเลื่อนขึ้น โดยจะแบ่งเป็นหมวดหมู่ต่าง ๆ ตามที่กำหนดใน Google Sheets เช่น

- ยอดเงินรวม: 100,000 บาท
- ยอดเงินบริจาค: 50,000 บาท
- ยอดสั่งจองพระเครื่อง: 10,000 บาท

รายชื่อผู้บริจาคจะแสดงในลักษณะข้อความเลื่อนขึ้น โดยเรียงลำดับจากยอดเงินบริจาคมากไปน้อย พร้อมทั้งอัปเดตข้อมูลอัตโนมัติทุก 10 นาที

---

## การปรับแต่งเพิ่มเติม

ผู้ใช้งานสามารถปรับแต่งเพิ่มเติมได้ตามต้องการ เช่น

- เปลี่ยนฟอนต์ตัวอักษร
- ปรับขนาดข้อความ
- เพิ่ม/ลด จำนวนข้อมูลที่แสดงผล

โดยการแก้ไขในไฟล์ `style.css` และ `main.js` ตามความเหมาะสม

---

## หากพบปัญหาในการใช้งาน หรือมีข้อเสนอแนะเพิ่มเติม

สามารถติดต่อ  
- ครูปิยะพล พวงบุบผา  
- ครูเบญจมาพร เรืองอร่าม  
- นายธีรภัทร์ ทองคำ

---

## License

MIT License © กลุ่มงานคอมพิวเตอร์ โรงเรียนชะอำคุณหญิงเนื่องบุรี 2025
